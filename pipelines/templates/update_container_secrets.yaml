parameters:
  - name: containerName
    type: string
  - name: resourceGroupName
    type: string

steps:
  - task: AzureCLI@2
    displayName: Update container secrets
    inputs:
      azureSubscription: $(armServiceConnectionDev)
      scriptType: bash
      scriptLocation: inlineScript
      inlineScript: |
        az --version
        az account show

        # Allow installing extension without a prompt
        # Required because of the containerapp command
        az config set extension.use_dynamic_install=yes_without_prompt

        az containerapp secret set -n {{ parameters.containerName }}  -g {{ parameters.resourceGroupName }} --secrets appsettings--mongodb--connectionstring=$(mongoDbConnectionString)
