name: $(app.version).$(Build.BuildID)_$(SourceBranchName)

pr:
  branches:
    include:
      - main

trigger:
  branches:
    include:
      - main
      - feature/gamePrices
  paths:
      include:
      - BGC.Functions
pool:
  vmImage: ubuntu-latest

steps:
  - task: UseDotNet@2
    displayName: Use .NET 6.0
    inputs:
      packageType: 'sdk'
      version: '6.0.x'

  - task: DotNetCoreCLI@2
    displayName: Dotnet Publish
    inputs:
      command: 'publish'
      publishWebProjects: false
      projects: 'BGC.Functions/*.csproj'
      modifyOutputPath: false
      arguments: '-o $(Build.ArtifactStagingDirectory) -a linux-x64'
  
  - task: PublishBuildArtifacts@1
    displayName: Publish Artifacts
    inputs:
      PathtoPublish: '$(Build.ArtifactStagingDirectory)/*.zip'
      ArtifactName: 'drop'
      publishLocation: 'Container'